version: '3'
services:
    theark:
        build: https://github.com/ritredteam/theark.git
        network_mode: 'host'
        privileged: true
        environment:
            - FLASK_DEBUG=false
            - FLASK_PORT=5000
            - ARK_DATABASE=/opt/theark/theark.sqlite
        volumes:
            - ./theark.sqlite:/opt/theark/theark.sqlite
        healthcheck:
            test: ["CMD", "curl", "-f", "http://0.0.0.0/"]
            interval: '10s'
            timeout: '10s'
            retries: 5
    sangheili:
        build: https://github.com/ritredteam/sangheili.git
        network_mode: 'host'
        privileged: true
        environment:
            - address_server=http://theark
            - reserve_addresses=True
            - address_count=50
        restart: on-failure
        depends_on:
            - theark